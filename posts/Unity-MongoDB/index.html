<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="MongoDB Cloud in Unity" /><meta property="og:locale" content="en" /><meta name="description" content="GitHub 내려받기" /><meta property="og:description" content="GitHub 내려받기" /><link rel="canonical" href="https://ugee0810.github.io//posts/Unity-MongoDB/" /><meta property="og:url" content="https://ugee0810.github.io//posts/Unity-MongoDB/" /><meta property="og:site_name" content="Ugee’s Tech Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-02T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MongoDB Cloud in Unity" /><meta name="twitter:site" content="@" /><meta name="google-site-verification" content="Ml2iJIkJ2zZDMNrcGMlCnS-Xedu1IYdjNWQKCAUzZKM" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-09-02T23:19:15+09:00","datePublished":"2022-09-02T00:00:00+09:00","description":"GitHub 내려받기","headline":"MongoDB Cloud in Unity","mainEntityOfPage":{"@type":"WebPage","@id":"https://ugee0810.github.io//posts/Unity-MongoDB/"},"url":"https://ugee0810.github.io//posts/Unity-MongoDB/"}</script><title>MongoDB Cloud in Unity | Ugee's Tech Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ugee's Tech Blog"><meta name="application-name" content="Ugee's Tech Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ugee's Tech Blog</a></div><div class="site-subtitle font-italic">Rearning to C# / Unity 21.3.x</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Ugee0810" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['shu990810','naver.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>MongoDB Cloud in Unity</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4 pb-5"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>MongoDB Cloud in Unity</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662044400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 2, 2022 </em> </span> <span> Updated <em class="" data-ts="1662128355" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 2, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/Ugee0810">송환욱(Song HwanUK)</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1701 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="github-내려받기"><a href="https://github.com/Ugee99/Unity-MongoDB-Test/tree/main">GitHub 내려받기</a></h1><h1 id="mongodb-atlas-database---cloud-dbaas-for-mongodb">MongoDB Atlas Database - Cloud DBaaS for MongoDB</h1><p>MongoDB는 자체적으로 서버를 구축해야하지만, 하위 플러그인으로 아틀라스DB를 사용하면 더 간단하게 무료(512MB)로 구축 가능하다.</p><h1 id="mongodb-프로젝트-생성-후-구축">MongoDB 프로젝트 생성 후 구축</h1><p><img data-src="https://user-images.githubusercontent.com/110334366/188042035-9d0bdd04-df1c-4f82-8dc1-ec275f07982e.png" alt="image" data-proofer-ignore></p><h1 id="mongodb-in-unity">MongoDB in Unity</h1><p>다운 받은 MongoDB Plugin을 에셋 폴더에 Import한다.</p><p>‘MongoDBCtrl.cs’ 생성 후 선언</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">MongoDB.Bson</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MongoDB.Driver</span><span class="p">;</span>
</pre></table></code></div></div><p>커넥션 주소를 정수 문자열로 받는다. <img data-src="https://user-images.githubusercontent.com/110334366/188044008-ddb15fbe-1b6a-40cc-a017-57621a7d21d2.png" alt="image" data-proofer-ignore></p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1">// xxx:xxx 아이디:비밀번호</span>
<span class="k">const</span> <span class="kt">string</span> <span class="n">MONGO_URI</span> <span class="p">=</span> <span class="s">"mongodb+srv://User:User@cluster0.lsm0ujc.mongodb.net/?retryWrites=true&amp;w=majority"</span><span class="p">;</span>
</pre></table></code></div></div><h2 id="get-connectuser-info--login"><span class="mr-2">＃Get Connect(User) Info : Login</span><a href="#get-connectuser-info--login" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">MongoDBCtrl</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">// 커넥트 정보 </span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">MONGO_URI</span> <span class="p">=</span> 
        <span class="s">"mongodb+srv://User:User@cluster0.lsm0ujc.mongodb.net/?retryWrites=true&amp;w=majority"</span><span class="p">;</span>

    <span class="n">MongoClient</span> <span class="n">client</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">DB_Login</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MongoClient</span><span class="p">(</span><span class="n">MONGO_URI</span><span class="p">);</span>
    <span class="p">}</span>


    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">DB_Login</span><span class="p">();</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">client</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="get-database-info"><span class="mr-2">＃Get Database Info</span><a href="#get-database-info" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">MongoDBCtrl</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">// 데이터베이스 가져오기</span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">DATABASE_NAME</span> <span class="p">=</span>
        <span class="s">"TestDB"</span><span class="p">;</span>

    <span class="n">IMongoDatabase</span> <span class="n">db</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Get_DataBase</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">db</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetDatabase</span><span class="p">(</span><span class="n">DATABASE_NAME</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="get-imongocollection"><span class="mr-2">＃Get IMongoCollection<Field_Data></Field_Data></span><a href="#get-imongocollection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">public</span> <span class="k">class</span> <span class="nc">MongoDBCtrl</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">// 이번엔 콜렉션이 하나이므로 전역변수로 가져오기(DB 안에선 여러 콜렉션이 있을 땐 내부 함수에서 가져오는걸 권장)</span>
    <span class="c1">// GameData Class의 형태로 생성</span>

    <span class="n">IMongoCollection</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">db_col</span><span class="p">;</span>

    <span class="k">void</span> <span class="nf">Get_Collection</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">db_col</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">GetCollection</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;(</span><span class="s">"TestDB.TestDB.col"</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="c1">// GameData.cs - 구조체로 콜렉션의 내용을 추가</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">GameData</span>
<span class="p">{</span>
    <span class="c1">// MongoDB 내에서 관리하는 객체</span>
    <span class="k">public</span> <span class="n">ObjectId</span> <span class="n">id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="insert--필드-추가"><span class="mr-2">＃Insert : 필드 추가</span><a href="#insert--필드-추가" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>    <span class="k">void</span> <span class="nf">db_Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">score</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">GameData</span> <span class="n">_GameData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameData</span><span class="p">();</span> <span class="c1">// 빈 데이터</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">name</span>  <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">score</span> <span class="p">=</span> <span class="n">score</span><span class="p">;</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">InsertOne</span><span class="p">(</span><span class="n">_GameData</span><span class="p">);</span>
    <span class="p">}</span>
</pre></table></code></div></div><h3 id="name-필드가-중복되지-되도록-c에서-제한하고-생성하기"><span class="mr-2">＃name 필드가 중복되지 되도록 C#에서 제한하고 생성하기</span><a href="#name-필드가-중복되지-되도록-c에서-제한하고-생성하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre>    <span class="k">void</span> <span class="nf">DB_Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">score</span> <span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// MongoDB 내에서 name필드에 중복이 있는지 검사</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">db_exist</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Name is Exist : "</span> <span class="p">+</span> <span class="n">name</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">GameData</span> <span class="n">_GameData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameData</span><span class="p">();</span> <span class="c1">// 빈 데이터</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">score</span> <span class="p">=</span> <span class="n">score</span><span class="p">;</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">InsertOne</span><span class="p">(</span><span class="n">_GameData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="nf">db_exist</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">_bson</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">user_data</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// 데이터가 없다면 false</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/110334366/188057535-15c0a5c4-58c8-4cf0-b37a-6586f92ac3c8.png" alt="image" data-proofer-ignore></p><h2 id="search--필드-검색"><span class="mr-2">＃Search : 필드 검색</span><a href="#search--필드-검색" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>    <span class="k">void</span> <span class="nf">DB_All_View</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">user</span> <span class="p">=&gt;</span> <span class="k">true</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span> <span class="c1">// 콜렉션을 리스트화 한다.</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span> <span class="c1">// 최적화를 위해 List 자료형 -&gt; 배열로 변환</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">user_data</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span> <span class="p">+</span> <span class="s">" : "</span> <span class="p">+</span> <span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">score</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></table></code></div></div><p>하지만 위의 방법은 보안은 좋지 않으므로 아래의 코드처럼 한 번 BsonDocumen를 거쳐 생성한다.</p><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>    <span class="k">void</span> <span class="nf">DB_Find</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">_bson</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">user_data</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span> <span class="p">+</span> <span class="s">" : "</span> <span class="p">+</span> <span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">score</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
</pre></table></code></div></div><p><img data-src="https://user-images.githubusercontent.com/110334366/188055103-6753da9c-cf55-4cb6-8a39-a90b07903b51.png" alt="image" data-proofer-ignore></p><p><img data-src="https://user-images.githubusercontent.com/110334366/188055042-d7b44024-9183-42ae-ac61-c5cac5808210.png" alt="image" data-proofer-ignore></p><h2 id="remove--필드-삭제"><span class="mr-2">＃Remove : 필드 삭제</span><a href="#remove--필드-삭제" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>사용 시 주의할 점 : Undo기능이 없으므로 신중하게 삭제해야 한다.</p><p>(보통의 서비스들은 1년의 복구기간을 준다. 하지만 이건 아님)</p><ul><li>DeleteOne() Method<li>DeleteMany() Method</ul><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>    <span class="c1">// 한 필드만 삭제</span>
    <span class="k">void</span> <span class="nf">DB_Remove</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span><span class="p">}</span> <span class="p">};</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteOne</span><span class="p">(</span><span class="n">_bson</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// 동일 name의 필드들을 삭제</span>
    <span class="k">void</span> <span class="nf">DB_Removes</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span><span class="p">}</span> <span class="p">};</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteMany</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// 전체 필드 삭제</span>
    <span class="k">void</span> <span class="nf">DB_Remove_All</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{};</span> <span class="c1">// &lt;- 모든 선택</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteMany</span><span class="p">(</span><span class="n">_bson</span><span class="p">);</span>
    <span class="p">}</span>
</pre></table></code></div></div><h2 id="update--필드-갱신"><span class="mr-2">＃Update : 필드 갱신</span><a href="#update--필드-갱신" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>    <span class="k">void</span> <span class="nf">DB_Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">score</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson_search</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span> <span class="c1">// 조회</span>
        <span class="n">BsonDocument</span> <span class="n">_bson_update</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">},</span> <span class="p">{</span> <span class="s">"score"</span><span class="p">,</span> <span class="n">score</span> <span class="p">}</span> <span class="p">};</span> <span class="c1">// Update</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">FindOneAndUpdate</span><span class="p">(</span><span class="n">_bson_search</span><span class="p">,</span> <span class="n">_bson_update</span><span class="p">);</span>
    <span class="p">}</span>
</pre></table></code></div></div><h1 id="전체-코드">전체 코드</h1><h2 id="mongodbctrlcs"><span class="mr-2">＃MongoDBCtrl.cs</span><a href="#mongodbctrlcs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
</pre><td class="rouge-code"><pre><span class="c1">/// &lt;summary&gt;</span>
<span class="c1">/// 클라이언트 내부 → 데이터베이스</span>
<span class="c1">/// 데이터베이스 내부 → 콜렉션</span>
<span class="c1">/// &lt;/summary&gt;</span>

<span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MongoDB.Bson</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MongoDB.Driver</span><span class="p">;</span>


<span class="k">public</span> <span class="k">class</span> <span class="nc">MongoDBCtrl</span> <span class="p">:</span> <span class="n">MonoBehaviour</span>
<span class="p">{</span>
    <span class="c1">// Get Connect(User) Info</span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">MONGO_URI</span> <span class="p">=</span> 
        <span class="s">"mongodb+srv://song:song@cluster0.qs1ppkp.mongodb.net/?retryWrites=true&amp;w=majority"</span><span class="p">;</span>
    <span class="n">MongoClient</span> <span class="n">client</span><span class="p">;</span>

    <span class="c1">// Get Database Info</span>
    <span class="k">const</span> <span class="kt">string</span> <span class="n">DATABASE_NAME</span> <span class="p">=</span> 
        <span class="s">"TestDB"</span><span class="p">;</span>
    <span class="n">IMongoDatabase</span> <span class="n">db</span><span class="p">;</span>

    <span class="c1">// - 예습에선 콜렉션이 하나이므로 전역변수로 관리</span>
    <span class="c1">// - DB 안에선 여러 콜렉션이 있을 땐 내부 함수에서 가져오는걸 권장</span>
    <span class="c1">// - GameData Class의 형태로 생성</span>
    <span class="n">IMongoCollection</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">db_col</span><span class="p">;</span>

    <span class="k">private</span> <span class="k">void</span> <span class="nf">Start</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">First</span><span class="p">();</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"=====:Action:====="</span><span class="p">);</span>
        <span class="c1">//DB_Find("song");</span>
        <span class="c1">//DB_All_View();</span>
        <span class="c1">//DB_Insert("ugi", 1);</span>
        <span class="c1">//DB_Remove("song");</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">First</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="nf">DB_Login</span><span class="p">();</span>
        <span class="nf">Get_DataBase</span><span class="p">();</span>
        <span class="nf">Get_Collection</span><span class="p">();</span>

        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"=====:접속 정보:====="</span><span class="p">);</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Client : "</span> <span class="p">+</span> <span class="n">client</span><span class="p">);</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"DataBase Name : "</span> <span class="p">+</span> <span class="n">db</span><span class="p">);</span>
        <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Data Collection : "</span> <span class="p">+</span> <span class="n">db_col</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">void</span> <span class="nf">DB_Login</span><span class="p">()</span>       <span class="p">{</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MongoClient</span><span class="p">(</span><span class="n">MONGO_URI</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">void</span> <span class="nf">Get_DataBase</span><span class="p">()</span>   <span class="p">{</span> <span class="n">db</span> <span class="p">=</span> <span class="n">client</span><span class="p">.</span><span class="nf">GetDatabase</span><span class="p">(</span><span class="n">DATABASE_NAME</span><span class="p">);</span> <span class="p">}</span>
    <span class="k">void</span> <span class="nf">Get_Collection</span><span class="p">()</span> <span class="p">{</span> <span class="n">db_col</span> <span class="p">=</span> <span class="n">db</span><span class="p">.</span><span class="n">GetCollection</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;(</span><span class="s">"TestDB.col"</span><span class="p">);</span> <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Insert</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">score</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// MongoDB 내에서 name필드에 중복이 있는지 검사</span>
        <span class="k">if</span> <span class="p">(</span><span class="nf">db_exist</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="s">"Name is Exist : "</span> <span class="p">+</span> <span class="n">name</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="n">GameData</span> <span class="n">_GameData</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GameData</span><span class="p">();</span> <span class="c1">// 빈 데이터</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">name</span> <span class="p">=</span> <span class="n">name</span><span class="p">;</span>
        <span class="n">_GameData</span><span class="p">.</span><span class="n">score</span> <span class="p">=</span> <span class="n">score</span><span class="p">;</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">InsertOne</span><span class="p">(</span><span class="n">_GameData</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kt">bool</span> <span class="nf">db_exist</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">_bson</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">user_data</span><span class="p">.</span><span class="n">Length</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="k">return</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// 데이터가 없다면 false</span>
        <span class="k">return</span> <span class="k">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_All_View</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">user</span> <span class="p">=&gt;</span> <span class="k">true</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span> <span class="c1">// 콜렉션을 리스트화 한다.</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span> <span class="c1">// 최적화를 위해 List 자료형 -&gt; 배열로 변환</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">user_data</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span> <span class="p">+</span> <span class="s">" : "</span> <span class="p">+</span> <span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">score</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Find</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// 데이터를 주고 받는 일은 json으로 보내어 보안을 강화한다.</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>
        <span class="n">List</span><span class="p">&lt;</span><span class="n">GameData</span><span class="p">&gt;</span> <span class="n">user_list</span> <span class="p">=</span> <span class="n">db_col</span><span class="p">.</span><span class="nf">Find</span><span class="p">(</span><span class="n">_bson</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="n">GameData</span><span class="p">[]</span> <span class="n">user_data</span> <span class="p">=</span> <span class="n">user_list</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">();</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">user_data</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="n">Debug</span><span class="p">.</span><span class="nf">Log</span><span class="p">(</span><span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">name</span> <span class="p">+</span> <span class="s">" : "</span> <span class="p">+</span> <span class="n">user_data</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">score</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Remove</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span> <span class="c1">// 한 필드만 삭제</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteOne</span><span class="p">(</span><span class="n">_bson</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Removes</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">)</span> <span class="c1">// 동일 name의 필드들을 삭제</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteMany</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Remove_All</span><span class="p">()</span> <span class="c1">// 전체 필드 삭제</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">};</span> <span class="c1">// &lt;- 모든 선택</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">DeleteMany</span><span class="p">(</span><span class="n">_bson</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">void</span> <span class="nf">DB_Update</span><span class="p">(</span><span class="kt">string</span> <span class="n">name</span><span class="p">,</span> <span class="kt">int</span> <span class="n">score</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">BsonDocument</span> <span class="n">_bson_search</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">}</span> <span class="p">};</span> <span class="c1">// 조회</span>
        <span class="n">BsonDocument</span> <span class="n">_bson_update</span> <span class="p">=</span> <span class="k">new</span> <span class="n">BsonDocument</span> <span class="p">{</span> <span class="p">{</span> <span class="s">"name"</span><span class="p">,</span> <span class="n">name</span> <span class="p">},</span> <span class="p">{</span> <span class="s">"score"</span><span class="p">,</span> <span class="n">score</span> <span class="p">}</span> <span class="p">};</span> <span class="c1">// Update</span>

        <span class="n">db_col</span><span class="p">.</span><span class="nf">FindOneAndUpdate</span><span class="p">(</span><span class="n">_bson_search</span><span class="p">,</span> <span class="n">_bson_update</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="gamedatacs"><span class="mr-2">＃GameData.cs</span><a href="#gamedatacs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><div class="language-c# highlighter-rouge"><div class="code-header"> <span data-label-text="C#"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System.Collections</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">UnityEngine</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MongoDB.Bson</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">MongoDB.Driver</span><span class="p">;</span>

<span class="c1">// GameData.cs - 구조체로 콜렉션의 내용을 추가</span>
<span class="k">public</span> <span class="k">class</span> <span class="nc">GameData</span>
<span class="p">{</span>
    <span class="c1">// MongoDB 내에서 관리하는 객체</span>
    <span class="k">public</span> <span class="n">ObjectId</span> <span class="n">id</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>  <span class="c1">// 필드의 고유 Index</span>
    <span class="k">public</span> <span class="kt">string</span> <span class="n">name</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
    <span class="k">public</span> <span class="kt">int</span> <span class="n">score</span> <span class="p">{</span> <span class="k">get</span><span class="p">;</span> <span class="k">set</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/unity/'>Unity</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/unity/" class="post-tag no-text-decoration" >Unity</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MongoDB+Cloud+in+Unity+-+Ugee%27s+Tech+Blog&url=https%3A%2F%2Fugee0810.github.io%2F%2Fposts%2FUnity-MongoDB%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MongoDB+Cloud+in+Unity+-+Ugee%27s+Tech+Blog&u=https%3A%2F%2Fugee0810.github.io%2F%2Fposts%2FUnity-MongoDB%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fugee0810.github.io%2F%2Fposts%2FUnity-MongoDB%2F&text=MongoDB+Cloud+in+Unity+-+Ugee%27s+Tech+Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div><script src="https://utteranc.es/client.js" repo="Ugee0810/Ugee0810.github.io" issue-term="pathname" theme="github-light" crossorigin="anonymous" async> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Algorithm-2/">Algorithm#02 | 버블 정렬(Bubble Sort)</a><li><a href="/posts/Algorithm-3/">Algorithm#03 | 삽입 정렬(Insertion Sort)</a><li><a href="/posts/Algorithm-1/">Algorithm#01 | 선택 정렬(Selection Sort)</a><li><a href="/posts/Algorithm-4/">Algorithm#04 | 퀵 정렬(Quick Sort)</a><li><a href="/posts/Unity-Event-2-Action/">Unity Event 2 - Action</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/diary/">Diary</a> <a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/data-structure/">Data Structure</a> <a class="post-tag" href="/tags/grammar/">Grammar</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/object-oriented-programming/">Object Oriented Programming</a> <a class="post-tag" href="/tags/sorting/">Sorting</a> <a class="post-tag" href="/tags/boj/">BOJ</a> <a class="post-tag" href="/tags/cordingtest/">CordingTest</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Data-Structure-01/"><div class="card-body"> <em class="small" data-ts="1662476400" data-df="ll" > Sep 7, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# Data Structure#01 | Collections 자료구조 정리</h3><div class="text-muted small"><p> 자료구조의 중요성 자료구조는 데이터를 메모리에 저장하는것입니다. 데이터량이 많을 때 목적에 맞는 자료구조를 사용하지 않으면 엄청난 비용(속도, 메모리 낭비)의 손실을 가져오거나 심지어 프로그램, 서버가 다운될 수도 있습니다. 데이터가 빈번하게 추가되거나 선입선출 등의 우선순위가 있거나 특정 값(Key)로 데이터를 뽑아올 경우가 있거나 등의 목적에 ...</p></div></div></a></div><div class="card"> <a href="/posts/Grammar-01/"><div class="card-body"> <em class="small" data-ts="1662562800" data-df="ll" > Sep 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# Grammar#01 | Switch</h3><div class="text-muted small"><p> Switch if - else 반복 줄임 가독성 높임 switch(n) 인수로는 기본적으로 정수와 문자를 넣을 수 있음 최근 C# 에서는 다른 타입의 객체도 넣을 수 있게끔 개선됐다. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 int choice = 0; switch(...</p></div></div></a></div><div class="card"> <a href="/posts/Grammar-02/"><div class="card-body"> <em class="small" data-ts="1662562800" data-df="ll" > Sep 8, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# Grammar#02 | enum</h3><div class="text-muted small"><p> enum 열거형 -&amp;gt; 같은 종류의 상수 모음 상수나 변수를 사용하는 이유 상수 리터럴을 통한 하드 코딩은 그 의미를 알기 쉽지 않고 리팩토링이 어렵기 때문에. enum 열거형을 사용하는 이유 상수이므로 의미를 알기 쉽다. 연관된 것들을 하나의 enum 으로 묶기 때...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Diary-220902/" class="btn btn-outline-primary" prompt="Older"><p>22-09-02(금)</p></a> <a href="/posts/Diary-220903/" class="btn btn-outline-primary" prompt="Newer"><p>22-09-03(토)</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/Ugee0810">송환욱(Song HwanUK)</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/c/">C#</a> <a class="post-tag" href="/tags/diary/">Diary</a> <a class="post-tag" href="/tags/unity/">Unity</a> <a class="post-tag" href="/tags/data-structure/">Data Structure</a> <a class="post-tag" href="/tags/grammar/">Grammar</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/object-oriented-programming/">Object Oriented Programming</a> <a class="post-tag" href="/tags/sorting/">Sorting</a> <a class="post-tag" href="/tags/boj/">BOJ</a> <a class="post-tag" href="/tags/cordingtest/">CordingTest</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-5PMP919232"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-5PMP919232'); }); </script>
